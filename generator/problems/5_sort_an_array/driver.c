/** IncludeLibs
 * This section is used to include the required libraries for proper functioning of the master and student solutions.
 * Some libraries might be appended here during execution from student solution, if not included here initially.
 */
// @IncludeLibs_Start
#include <assert.h>
#include <klee/klee.h>
#include <stdlib.h>
// @IncludeLibs_End

#define SIZE 5

/** DeclareFunctionProtypes
 * This section is used to declare the function prototypes for the master and student solution methods.
 * Keep note of the return type and param types.
 */
// @DeclareFunctionProtypes_Start
void solve_master(int *, int);
void solve_student(int *, int);
// @DeclareFunctionProtypes_End

// Include the AutoVal method prototypes [IMPORTANT]
void klee_make_symbolic(void *addr, size_t nbytes, const char *name);
// void atvl_set_value();

int main() {
    /** DeclareParams
     * This section is used to declare the variables for the function parameters.
     * Here, we declare the parameters to be passed as inputs to the master and student solutions.
     */
    // @DeclareParams_Start
    int input[SIZE];
    int a[SIZE];
    int b[SIZE];
    int n;
    // @DeclareParams_End

    /** SetSymbols
     * This section is used to set variables as symbols by calling the atvl_mksym() method.
     * This is an important section, since, this will be manipulated later on to run the testcases.
     * Here testcases are the counter-examples that are generated by KLEE during assertion check.
     */
    // @SetSymbols_Start
    klee_make_symbolic(input, sizeof(input), "input");
    klee_make_symbolic(&n, sizeof(n), "n");
    for (int i = 0; i < SIZE; i++) {
        // klee_assume(input[i] >= 0 && input[i] <= 2);  // small value space
        a[i] = input[i];
        b[i] = input[i];
    }
    // @SetSymbols_End

    /** CheckPreConditions
     * This section is used to assert the Pre-conditions for the input space.
     */
    // @CheckPreConditions_Start
    // if (n < 1) exit(EXIT_FAILURE);
    // if (n > 10) exit(EXIT_FAILURE);
    klee_assume(n >= 1 && n <= SIZE);
    // @CheckPreConditions_End

    /** CallMethods
     * This section is used to execute the master (i.e., the reference solution) and the student submitted solutions.
     * The return values, i.e, the outputs of the functions are acquired to later on assert the semantic equivalence.
     * The same set of parameters are passed on to both the master and the student solutions/ methods.
     */
    // @CallMethods_Start
    solve_master(a, n);
    solve_student(b, n);
    // @CallMethods_End

    /** CheckAssertions
     * This section is used to assert the simmilarities of the outputs of the master and student methods.
     */
    // @CheckAssertions_Start
    for (int i = 0; i < n; i++) {
        klee_assert(a[i] == b[i]);
    }
    // @CheckAssertions_End

    return 0;
}
